const _0x27f227=_0x1e86;(function(_0x589b20,_0x526945){const _0x589842=_0x1e86,_0x20609d=_0x589b20();while(!![]){try{const _0x168d23=parseInt(_0x589842(0x157))/0x1+parseInt(_0x589842(0x12d))/0x2+-parseInt(_0x589842(0x13b))/0x3+parseInt(_0x589842(0x13a))/0x4*(parseInt(_0x589842(0x144))/0x5)+parseInt(_0x589842(0x137))/0x6+parseInt(_0x589842(0x167))/0x7*(-parseInt(_0x589842(0x128))/0x8)+parseInt(_0x589842(0x164))/0x9*(-parseInt(_0x589842(0x161))/0xa);if(_0x168d23===_0x526945)break;else _0x20609d['push'](_0x20609d['shift']());}catch(_0x4c6cfa){_0x20609d['push'](_0x20609d['shift']());}}}(_0x1a28,0xc3beb));function _0x1a28(){const _0x1e0643=['find','express','windows','page','页面不存在','8pkYMhM','/:page','start\x20http://localhost:','🚀\x20开始构建...','error','2696422JjLwsE','map','node','❌\x20切换目录失败','get','status','static','.html','use','<li><a\x20href=\x22/','4551918OvIHQa','inherit','❌\x20指定的版本\x20','28QyMfVz','804612LmZItJ','filter','✅\x20Web\x20构建完成','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<!DOCTYPE\x20html>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<html>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<head><title>可用页面列表</title></head>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<body>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h1>可用页面列表:</h1>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<ul>','exit','EADDRINUSE','path','❌\x20运行错误:','📂\x20请检查目录:\x20','379825QtkjMu','electron','parse','child_process','--start-web','</ul>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</body>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</html>\x0a\x20\x20\x20\x20\x20\x20','index.html','✅\x20HTTP\x20服务已启动:\x20http://localhost:','readdirSync','🚀\x20开始\x20Web\x20构建...','slice','✅\x20构建完成','endsWith','❌\x20请指定运行模式:\x20--electron,\x20--web,\x20--start-electron\x20或\x20--start-web','code','❌\x20Web\x20构建失败','❌\x20构建失败','includes','--web','1449699xbHCoi','scripts/build.js','package.json','send','dist','❌\x20服务器错误:','📂\x20静态文件目录:','</a></li>','existsSync','listen','1104650PvTPjX','--build','join','198WLmHfo','--electron','sendFile','4116791IlbFSy','❌\x20端口\x20','startsWith','version','log','--v=','split','--port=','out','web'];_0x1a28=function(){return _0x1e0643;};return _0x1a28();}const {spawnSync}=require('child_process'),path=require(_0x27f227(0x141)),fs=require('fs'),{exec}=require(_0x27f227(0x147)),express=require(_0x27f227(0x124)),outDir=path['join'](__dirname,'..',_0x27f227(0x121)),distDir=path['join'](outDir,_0x27f227(0x125),'dist'),packageJson=JSON[_0x27f227(0x146)](fs['readFileSync'](path[_0x27f227(0x163)](__dirname,'..',_0x27f227(0x159)),'utf-8')),args=process['argv'][_0x27f227(0x14e)](0x2),isElectron=args['includes'](_0x27f227(0x165)),isWeb=args['includes'](_0x27f227(0x156)),isStartElectron=args[_0x27f227(0x155)]('--start-electron'),isStartWeb=args[_0x27f227(0x155)](_0x27f227(0x148)),portArg=args[_0x27f227(0x123)](_0x29470b=>_0x29470b['startsWith'](_0x27f227(0x120))),port=portArg?parseInt(portArg[_0x27f227(0x16d)]('=')[0x1]):0x1496,versionArg=args['find'](_0x53aadd=>_0x53aadd[_0x27f227(0x169)](_0x27f227(0x16c))),versionName=versionArg?'v'+versionArg[_0x27f227(0x16d)]('=')[0x1]:'v'+packageJson[_0x27f227(0x16a)],webDistDir=path['join'](__dirname,'..',_0x27f227(0x15b),_0x27f227(0x122),versionName);versionArg&&!fs[_0x27f227(0x15f)](webDistDir)&&(console[_0x27f227(0x12c)](_0x27f227(0x139)+versionName+'\x20不存在'),console[_0x27f227(0x16b)](_0x27f227(0x143)+webDistDir),process[_0x27f227(0x13f)](0x1));function runBuild(){const _0x1dd4fd=_0x27f227;console[_0x1dd4fd(0x16b)](_0x1dd4fd(0x12b));const _0x132cdf=spawnSync(_0x1dd4fd(0x12f),['scripts/build.js',_0x1dd4fd(0x162)],{'stdio':_0x1dd4fd(0x138),'shell':!![],'cwd':path['join'](__dirname,'..')});_0x132cdf[_0x1dd4fd(0x132)]!==0x0&&(console[_0x1dd4fd(0x12c)](_0x1dd4fd(0x154)),process[_0x1dd4fd(0x13f)](0x1)),console['log'](_0x1dd4fd(0x14f));}function _0x1e86(_0x1f099c,_0x313945){const _0x1a2868=_0x1a28();return _0x1e86=function(_0x1e862c,_0x464ceb){_0x1e862c=_0x1e862c-0x120;let _0x4e6cdb=_0x1a2868[_0x1e862c];return _0x4e6cdb;},_0x1e86(_0x1f099c,_0x313945);}function checkBuildExists(){const _0x35c54d=_0x27f227;return fs[_0x35c54d(0x15f)](distDir);}function startElectron(){const _0x2a8d31=_0x27f227;console[_0x2a8d31(0x16b)]('🚀\x20启动\x20Electron...');const _0x15d22a=spawnSync('cd',[outDir],{'stdio':_0x2a8d31(0x138),'shell':!![]});_0x15d22a[_0x2a8d31(0x132)]!==0x0&&(console['error'](_0x2a8d31(0x130)),process[_0x2a8d31(0x13f)](0x1));const _0xaa7ba=spawnSync(_0x2a8d31(0x145),['.'],{'stdio':_0x2a8d31(0x138),'shell':!![],'cwd':outDir});_0xaa7ba[_0x2a8d31(0x132)]!==0x0&&(console[_0x2a8d31(0x12c)]('❌\x20Electron\x20启动失败'),process[_0x2a8d31(0x13f)](0x1));}function createHttpServer(){const _0x72076e=_0x27f227,_0x37bf69=express();console[_0x72076e(0x16b)](_0x72076e(0x15d),webDistDir),_0x37bf69[_0x72076e(0x135)](express[_0x72076e(0x133)](webDistDir)),_0x37bf69[_0x72076e(0x131)]('/',(_0x39cf25,_0x5450c2)=>{const _0x18c014=_0x72076e,_0x2edd3f=path[_0x18c014(0x163)](webDistDir,_0x18c014(0x14a));if(fs[_0x18c014(0x15f)](_0x2edd3f))_0x5450c2[_0x18c014(0x166)](_0x2edd3f);else{const _0x474419=fs[_0x18c014(0x14c)](webDistDir)[_0x18c014(0x13c)](_0x1158af=>_0x1158af[_0x18c014(0x150)](_0x18c014(0x134)))[_0x18c014(0x12e)](_0x568044=>_0x18c014(0x136)+_0x568044+'\x22>'+_0x568044+_0x18c014(0x15e))['join']('\x0a');_0x5450c2[_0x18c014(0x15a)](_0x18c014(0x13e)+_0x474419+_0x18c014(0x149));}}),_0x37bf69[_0x72076e(0x131)](_0x72076e(0x129),(_0x23dab2,_0x13b317,_0x2be7ee)=>{const _0x1c89db=_0x72076e,_0xa8897d=_0x23dab2['params'][_0x1c89db(0x126)];if(!_0xa8897d[_0x1c89db(0x150)](_0x1c89db(0x134))){_0x2be7ee();return;}const _0x439a69=path['join'](webDistDir,_0xa8897d);fs[_0x1c89db(0x15f)](_0x439a69)?_0x13b317['sendFile'](_0x439a69):_0x13b317[_0x1c89db(0x132)](0x194)[_0x1c89db(0x15a)](_0x1c89db(0x127));});const _0x2b408f=_0x37bf69[_0x72076e(0x160)](port,()=>{const _0x5957b1=_0x72076e;console['log'](_0x5957b1(0x14b)+port),exec(_0x5957b1(0x12a)+port);});_0x2b408f['on'](_0x72076e(0x12c),_0x596249=>{const _0x5ad2b9=_0x72076e;_0x596249[_0x5ad2b9(0x152)]===_0x5ad2b9(0x140)?console['error'](_0x5ad2b9(0x168)+port+'\x20已被占用'):console[_0x5ad2b9(0x12c)](_0x5ad2b9(0x15c),_0x596249),process['exit'](0x1);});}function runWebBuild(){const _0x396fb0=_0x27f227;console[_0x396fb0(0x16b)](_0x396fb0(0x14d));const _0x58826d=spawnSync(_0x396fb0(0x12f),[_0x396fb0(0x158),'--web'],{'stdio':_0x396fb0(0x138),'shell':!![],'cwd':path[_0x396fb0(0x163)](__dirname,'..')});_0x58826d['status']!==0x0&&(console['error'](_0x396fb0(0x153)),process[_0x396fb0(0x13f)](0x1)),console['log'](_0x396fb0(0x13d));}function checkWebBuildExists(){const _0x371ea5=_0x27f227;return fs[_0x371ea5(0x15f)](webDistDir);}async function main(){const _0x44651a=_0x27f227;if(isElectron)runBuild(),startElectron();else{if(isWeb)runWebBuild(),createHttpServer();else{if(isStartElectron)!checkBuildExists()&&runBuild(),startElectron();else isStartWeb?(!checkWebBuildExists()&&runWebBuild(),createHttpServer()):(console[_0x44651a(0x12c)](_0x44651a(0x151)),process['exit'](0x1));}}}main()['catch'](_0x31ac1b=>{const _0x1ede26=_0x27f227;console[_0x1ede26(0x12c)](_0x1ede26(0x142),_0x31ac1b),process['exit'](0x1);});