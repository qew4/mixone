const _0x1e5267=_0x5726;(function(_0x19da1a,_0x383782){const _0x303eff=_0x5726,_0x54713f=_0x19da1a();while(!![]){try{const _0x47462e=-parseInt(_0x303eff(0xcf))/0x1*(-parseInt(_0x303eff(0xf7))/0x2)+parseInt(_0x303eff(0xb0))/0x3+parseInt(_0x303eff(0xe4))/0x4*(parseInt(_0x303eff(0xe5))/0x5)+parseInt(_0x303eff(0xb6))/0x6*(-parseInt(_0x303eff(0xd0))/0x7)+-parseInt(_0x303eff(0xbf))/0x8+parseInt(_0x303eff(0xe0))/0x9+-parseInt(_0x303eff(0xef))/0xa;if(_0x47462e===_0x383782)break;else _0x54713f['push'](_0x54713f['shift']());}catch(_0x3fdd9b){_0x54713f['push'](_0x54713f['shift']());}}}(_0xb456,0x35ba4));const {spawnSync}=require(_0x1e5267(0xd6)),path=require('path'),fs=require('fs'),{exec}=require(_0x1e5267(0xd6)),express=require('express'),outDir=path[_0x1e5267(0xb7)](__dirname,'..',_0x1e5267(0xb9)),distDir=path[_0x1e5267(0xb7)](outDir,_0x1e5267(0xb5),'dist'),packageJson=JSON[_0x1e5267(0xeb)](fs[_0x1e5267(0xe2)](path[_0x1e5267(0xb7)](__dirname,'..','package.json'),_0x1e5267(0xba))),args=process[_0x1e5267(0xe3)][_0x1e5267(0xb3)](0x2),isElectron=args['includes'](_0x1e5267(0xf6)),isWeb=args['includes']('--web'),isStartElectron=args[_0x1e5267(0xe6)](_0x1e5267(0xe7)),isStartWeb=args[_0x1e5267(0xe6)]('--start-web'),portArg=args['find'](_0x456f19=>_0x456f19[_0x1e5267(0xee)](_0x1e5267(0xd8))),port=portArg?parseInt(portArg['split']('=')[0x1]):0x1496,versionArg=args[_0x1e5267(0xd4)](_0x26737b=>_0x26737b[_0x1e5267(0xee)]('--v=')),versionName=versionArg?'v'+versionArg[_0x1e5267(0xd1)]('=')[0x1]:'v'+packageJson[_0x1e5267(0xd5)],webDistDir=path['join'](__dirname,'..',_0x1e5267(0xf2),'web',versionName);versionArg&&!fs['existsSync'](webDistDir)&&(console[_0x1e5267(0xbb)](_0x1e5267(0xf1)+versionName+_0x1e5267(0xcb)),console[_0x1e5267(0xc7)](_0x1e5267(0xb2)+webDistDir),process[_0x1e5267(0xdb)](0x1));function runBuild(){const _0x177d57=_0x1e5267;console[_0x177d57(0xc7)](_0x177d57(0xca));const _0x3923e5=spawnSync(_0x177d57(0xda),[_0x177d57(0xc1),'--build'],{'stdio':_0x177d57(0xe8),'shell':!![],'cwd':path[_0x177d57(0xb7)](__dirname,'..')});_0x3923e5['status']!==0x0&&(console[_0x177d57(0xbb)](_0x177d57(0xec)),process['exit'](0x1)),console[_0x177d57(0xc7)](_0x177d57(0xf8));}function _0x5726(_0x1f62e0,_0x3d1761){const _0xb456c6=_0xb456();return _0x5726=function(_0x5726a2,_0x54152c){_0x5726a2=_0x5726a2-0xb0;let _0x5a246d=_0xb456c6[_0x5726a2];return _0x5a246d;},_0x5726(_0x1f62e0,_0x3d1761);}function _0xb456(){const _0x3c81bc=['281883LUZyPT','split','EADDRINUSE','electron','find','version','child_process','❌\x20运行错误:','--port=','readdirSync','node','exit','params','get','❌\x20Electron\x20启动失败','index.html','1413252QnynKE','❌\x20请指定运行模式:\x20--electron,\x20--web,\x20--start-electron\x20或\x20--start-web','readFileSync','argv','172uTGpVm','35205xrFwYp','includes','--start-electron','inherit','/:page','status','parse','❌\x20构建失败','❌\x20端口\x20','startsWith','4575910UARnXZ','listen','❌\x20指定的版本\x20','dist','<li><a\x20href=\x22/','code','\x20已被占用','--electron','201298aNHJUb','✅\x20构建完成','641391gLrhfP','--web','📂\x20请检查目录:\x20','slice','</ul>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</body>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</html>\x0a\x20\x20\x20\x20\x20\x20','windows','6UWHsUu','join','send','out','utf-8','error','endsWith','🚀\x20开始\x20Web\x20构建...','📂\x20静态文件目录:','450472OxmYmc','.html','scripts/build.js','sendFile','catch','page','❌\x20Web\x20构建失败','existsSync','log','</a></li>','start\x20http://localhost:','🚀\x20开始构建...','\x20不存在','页面不存在','✅\x20HTTP\x20服务已启动:\x20http://localhost:','✅\x20Web\x20构建完成','1aicqtP'];_0xb456=function(){return _0x3c81bc;};return _0xb456();}function checkBuildExists(){const _0x1b2cdd=_0x1e5267;return fs[_0x1b2cdd(0xc6)](distDir);}function startElectron(){const _0x2d1c8e=_0x1e5267;console[_0x2d1c8e(0xc7)]('🚀\x20启动\x20Electron...');const _0x342123=spawnSync('cd',[outDir],{'stdio':_0x2d1c8e(0xe8),'shell':!![]});_0x342123[_0x2d1c8e(0xea)]!==0x0&&(console[_0x2d1c8e(0xbb)]('❌\x20切换目录失败'),process[_0x2d1c8e(0xdb)](0x1));const _0x30fe1b=spawnSync(_0x2d1c8e(0xd3),['.'],{'stdio':_0x2d1c8e(0xe8),'shell':!![],'cwd':outDir});_0x30fe1b[_0x2d1c8e(0xea)]!==0x0&&(console[_0x2d1c8e(0xbb)](_0x2d1c8e(0xde)),process[_0x2d1c8e(0xdb)](0x1));}function createHttpServer(){const _0x274065=_0x1e5267,_0x3ab822=express();console[_0x274065(0xc7)](_0x274065(0xbe),webDistDir),_0x3ab822['use'](express['static'](webDistDir)),_0x3ab822[_0x274065(0xdd)]('/',(_0x43a932,_0x4fd665)=>{const _0x3dc922=_0x274065,_0x21344d=path[_0x3dc922(0xb7)](webDistDir,_0x3dc922(0xdf));if(fs[_0x3dc922(0xc6)](_0x21344d))_0x4fd665[_0x3dc922(0xc2)](_0x21344d);else{const _0x92632e=fs[_0x3dc922(0xd9)](webDistDir)['filter'](_0x24f6ca=>_0x24f6ca['endsWith'](_0x3dc922(0xc0)))['map'](_0x4e1735=>_0x3dc922(0xf3)+_0x4e1735+'\x22>'+_0x4e1735+_0x3dc922(0xc8))[_0x3dc922(0xb7)]('\x0a');_0x4fd665[_0x3dc922(0xb8)]('\x0a\x20\x20\x20\x20\x20\x20\x20\x20<!DOCTYPE\x20html>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<html>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<head><title>可用页面列表</title></head>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<body>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h1>可用页面列表:</h1>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<ul>'+_0x92632e+_0x3dc922(0xb4));}}),_0x3ab822['get'](_0x274065(0xe9),(_0xe6c712,_0xb9a41d,_0x394740)=>{const _0x267921=_0x274065,_0x2a6490=_0xe6c712[_0x267921(0xdc)][_0x267921(0xc4)];if(!_0x2a6490[_0x267921(0xbc)](_0x267921(0xc0))){_0x394740();return;}const _0x418362=path[_0x267921(0xb7)](webDistDir,_0x2a6490);fs[_0x267921(0xc6)](_0x418362)?_0xb9a41d[_0x267921(0xc2)](_0x418362):_0xb9a41d[_0x267921(0xea)](0x194)[_0x267921(0xb8)](_0x267921(0xcc));});const _0x88b7c5=_0x3ab822[_0x274065(0xf0)](port,()=>{const _0x5a34e5=_0x274065;console[_0x5a34e5(0xc7)](_0x5a34e5(0xcd)+port),exec(_0x5a34e5(0xc9)+port);});_0x88b7c5['on']('error',_0x46b1cf=>{const _0x58db20=_0x274065;_0x46b1cf[_0x58db20(0xf4)]===_0x58db20(0xd2)?console[_0x58db20(0xbb)](_0x58db20(0xed)+port+_0x58db20(0xf5)):console['error']('❌\x20服务器错误:',_0x46b1cf),process[_0x58db20(0xdb)](0x1);});}function runWebBuild(){const _0x5ed05e=_0x1e5267;console[_0x5ed05e(0xc7)](_0x5ed05e(0xbd));const _0x4feca5=spawnSync(_0x5ed05e(0xda),['scripts/build.js',_0x5ed05e(0xb1)],{'stdio':_0x5ed05e(0xe8),'shell':!![],'cwd':path['join'](__dirname,'..')});_0x4feca5[_0x5ed05e(0xea)]!==0x0&&(console[_0x5ed05e(0xbb)](_0x5ed05e(0xc5)),process['exit'](0x1)),console['log'](_0x5ed05e(0xce));}function checkWebBuildExists(){const _0x5498a0=_0x1e5267;return fs[_0x5498a0(0xc6)](webDistDir);}async function main(){const _0x10fe59=_0x1e5267;if(isElectron)runBuild(),startElectron();else{if(isWeb)runWebBuild(),createHttpServer();else{if(isStartElectron)!checkBuildExists()&&runBuild(),startElectron();else isStartWeb?(!checkWebBuildExists()&&runWebBuild(),createHttpServer()):(console['error'](_0x10fe59(0xe1)),process[_0x10fe59(0xdb)](0x1));}}}main()[_0x1e5267(0xc3)](_0x3cf937=>{const _0x2095f0=_0x1e5267;console[_0x2095f0(0xbb)](_0x2095f0(0xd7),_0x3cf937),process['exit'](0x1);});